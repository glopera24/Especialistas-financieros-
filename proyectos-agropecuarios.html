<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Asesor√≠a para Proyectos Agropecuarios</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Definici√≥n de estilos reutilizables con Tailwind CSS */
        .input {
            @apply border border-gray-300 rounded-md p-2 w-full focus:outline-none focus:ring-2 focus:ring-green-500;
        }
    </style>
</head>
<body class="bg-gray-50 font-sans text-gray-800">

    <section class="bg-green-800 text-white py-16 px-6">
        <div class="max-w-4xl mx-auto text-center">
            <h1 class="text-4xl font-bold mb-4">¬øNecesitas elaborar o mejorar tu proyecto productivo agropecuario?</h1>
            <p class="text-xl mb-6">Te ayudamos a estructurarlo, optimizarlo y dejarlo listo en PDF para presentarlo ante bancos, alcald√≠as o entidades de cooperaci√≥n.</p>
            <p class="text-lg font-semibold">Solo completa el formulario y nosotros nos encargamos del resto.</p>
        </div>
    </section>

    <section class="max-w-5xl mx-auto py-10 px-6">
        <form action="https://formspree.io/f/myzppnrz" method="POST" class="bg-white shadow-md rounded-lg p-8 space-y-8">

            <h2 class="text-2xl font-bold text-green-700">Formulario para la Elaboraci√≥n de tu Proyecto</h2>

            <div>
                <h3 class="text-lg font-semibold text-green-700 mb-2">1. Datos del Productor</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <input type="text" name="nombre" placeholder="Nombre completo" class="input" required>
                    <input type="text" name="documento" placeholder="Documento de identidad" class="input" required>
                    <input type="email" name="correo" placeholder="Correo electr√≥nico" class="input" required>
                    <input type="tel" name="telefono" placeholder="Tel√©fono de contacto" class="input" required>
                </div>
            </div>

            <div>
                <h3 class="text-lg font-semibold text-green-700 mb-2">2. Informaci√≥n del Predio</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <input type="text" name="ubicacion" placeholder="Ubicaci√≥n del predio (vereda, municipio)" class="input" required>
                    <input type="text" name="area" placeholder="√Årea total (hect√°reas)" class="input" required>
                    <select name="tenencia" class="input" required>
                        <option value="">Tipo de tenencia</option>
                        <option value="propio">Propio</option>
                        <option value="arrendado">Arrendado</option>
                        <option value="familiar">Familiar</option>
                    </select>
                    <textarea id="infraestructura" name="infraestructura" rows="2" placeholder="Infraestructura existente (galpones, agua, etc.)" class="input"></textarea>
                    <div class="mt-2 text-sm text-gray-600 col-span-full">
                        ¬øQu√© infraestructura tienes? <button type="button" onclick="generarTextoIA('infraestructura', 'respuestaInfraestructura', 'Ejemplos de infraestructura existente en el predio: Galpones, establos, sistemas de riego por goteo, pozos profundos, cercas perimetrales, bodegas de almacenamiento, electrificaci√≥n rural.')" class="text-green-700 underline">üí° Generar con IA</button>
                    </div>
                    <div id="respuestaInfraestructura" class="hidden mt-2 bg-green-50 border-l-4 border-green-600 p-3 text-sm text-green-800 rounded col-span-full"></div>
                </div>
            </div>

            <div>
                <h3 class="text-lg font-semibold text-green-700 mb-2">3. Detalles del Proyecto</h3>
                <textarea id="descripcion" name="descripcion" rows="3" placeholder="¬øQu√© deseas producir? ¬øCu√°l es el objetivo del proyecto?" class="input w-full" required></textarea>
                <div class="mt-2 text-sm text-gray-600">
                    ¬øNo sabes c√≥mo empezar? <button type="button" onclick="generarTextoIA('descripcion', 'respuestaDescripcion', 'Describe en detalle el proyecto productivo que deseas implementar. ¬øQu√© tipo de cultivo o animal planeas producir? ¬øCu√°l es la escala esperada? Por ejemplo: "Este proyecto busca establecer una granja av√≠cola de [X] gallinas ponedoras para la producci√≥n de [Y] huevos diarios, con el objetivo de abastecer el mercado local y generar ingresos sostenibles."')" class="text-green-700 underline">üí° Generar con IA</button>
                </div>
                <div id="respuestaDescripcion" class="hidden mt-2 bg-green-50 border-l-4 border-green-600 p-3 text-sm text-green-800 rounded"></div>

                <textarea id="objetivos" name="objetivos" rows="2" placeholder="Objetivos espec√≠ficos del proyecto" class="input w-full mt-4" required></textarea>
                <div class="mt-2 text-sm text-gray-600">
                    ¬øNecesitas ayuda con los objetivos? <button type="button" onclick="generarTextoIA('objetivos', 'respuestaObjetivos', 'Define los objetivos espec√≠ficos y medibles de tu proyecto. ¬øQu√© quieres lograr en t√©rminos de producci√≥n, eficiencia, impacto social o ambiental? Por ejemplo: "Los objetivos del proyecto son: 1. Alcanzar una producci√≥n de [X] toneladas/litros/unidades de [Producto] en el primer a√±o. 2. Reducir los costos de producci√≥n en un [Y]% mediante la implementaci√≥n de nuevas tecnolog√≠as. 3. Generar [Z] empleos directos para la comunidad local."')" class="text-green-700 underline">üí° Generar con IA</button>
                </div>
                <div id="respuestaObjetivos" class="hidden mt-2 bg-green-50 border-l-4 border-green-600 p-3 text-sm text-green-800 rounded"></div>
            </div>

            <div>
                <h3 class="text-lg font-semibold text-green-700 mb-2">4. Proyecci√≥n Financiera</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <input type="number" id="inversion" name="inversion" placeholder="Valor total estimado (COP)" class="input" required>
                    <div class="mt-2 text-sm text-gray-600 col-span-full">
                        ¬øEstimaci√≥n de inversi√≥n? <button type="button" onclick="generarTextoIA('inversion', 'respuestaInversion', 'Considera los costos de terreno, semillas/animales, infraestructura, maquinaria, mano de obra, insumos, permisos. Una inversi√≥n total estimada podr√≠a ser de COP 150.000.000.')" class="text-green-700 underline">üí° Generar con IA</button>
                    </div>
                    <div id="respuestaInversion" class="hidden mt-2 bg-green-50 border-l-4 border-green-600 p-3 text-sm text-green-800 rounded col-span-full"></div>

                    <input type="number" id="aporte" name="aporte" placeholder="Aporte propio (COP)" class="input" required>
                    <div class="mt-2 text-sm text-gray-600 col-span-full">
                        ¬øCu√°nto aportas t√∫? <button type="button" onclick="generarTextoIA('aporte', 'respuestaAporte', 'Tu aporte propio puede incluir efectivo, terrenos, maquinaria existente, o mano de obra valorada. Un aporte propio podr√≠a ser de COP 50.000.000.')" class="text-green-700 underline">üí° Generar con IA</button>
                    </div>
                    <div id="respuestaAporte" class="hidden mt-2 bg-green-50 border-l-4 border-green-600 p-3 text-sm text-green-800 rounded col-span-full"></div>

                    <input type="number" id="financiado" name="financiado" placeholder="Valor solicitado a entidad (COP)" class="input">
                    <div class="mt-2 text-sm text-gray-600 col-span-full">
                        ¬øCu√°nto necesitas prestado? <button type="button" onclick="generarTextoIA('financiado', 'respuestaFinanciado', 'El valor solicitado a la entidad financiera debe ser la diferencia entre la inversi√≥n total y tu aporte propio. Por ejemplo, si la inversi√≥n total es COP 150.000.000 y tu aporte es COP 50.000.000, solicitar√≠as COP 100.000.000.')" class="text-green-700 underline">üí° Generar con IA</button>
                    </div>
                    <div id="respuestaFinanciado" class="hidden mt-2 bg-green-50 border-l-4 border-green-600 p-3 text-sm text-green-800 rounded col-span-full"></div>

                    <textarea id="proyeccion" name="proyeccion" rows="2" placeholder="Ingresos esperados por mes o por ciclo" class="input w-full mt-2"></textarea>
                    <div class="mt-2 text-sm text-gray-600 col-span-full">
                        ¬øC√≥mo proyectas tus ingresos? <button type="button" onclick="generarTextoIA('proyeccion', 'respuestaProyeccion', 'Proyecta los ingresos esperados de tu proyecto. ¬øCu√°nto producto se vender√° y a qu√© precio? Por ejemplo: "Se proyectan ingresos mensuales de COP [X] por la venta de [Y] unidades de [Producto], con un crecimiento anual del [Z]%."')" class="text-green-700 underline">üí° Generar con IA</button>
                    </div>
                    <div id="respuestaProyeccion" class="hidden mt-2 bg-green-50 border-l-4 border-green-600 p-3 text-sm text-green-800 rounded col-span-full"></div>
                </div>
            </div>

            <div class="mb-6">
                <h3 class="text-lg font-semibold text-green-700 mb-2">5. Impacto Esperado</h3>
                <textarea id="impacto" name="impacto" rows="4" placeholder="Describe el impacto esperado..." class="input" required></textarea>
                <div class="mt-2 text-sm text-gray-600">
                    ¬øNo sabes qu√© escribir? <button type="button" onclick="generarTextoIA('impacto', 'respuestaIA', 'Describe el impacto positivo que tu proyecto tendr√° en la comunidad, el medio ambiente y la econom√≠a local. Por ejemplo: "El proyecto generar√° [X] empleos directos e indirectos, contribuir√° a la seguridad alimentaria de la regi√≥n, implementar√° pr√°cticas agr√≠colas sostenibles como [ejemplo], y fortalecer√° la econom√≠a rural."')" class="text-green-700 underline">üí° Generar con IA</button>
                </div>
                <div id="respuestaIA" class="hidden mt-2 bg-green-50 border-l-4 border-green-600 p-3 text-sm text-green-800 rounded"></div>
            </div>

            <div>
                <h3 class="text-lg font-semibold text-green-700 mb-2">6. Comercializaci√≥n</h3>
                <textarea id="mercado" name="mercado" rows="3" placeholder="¬øA qui√©n piensa vender? ¬øTiene clientes potenciales?" class="input w-full" required></textarea>
                <div class="mt-2 text-sm text-gray-600">
                    ¬øNecesitas una idea? <button type="button" onclick="generarTextoIA('mercado', 'respuestaMercado', 'Describe tu estrategia de comercializaci√≥n. ¬øQui√©nes son tus clientes objetivo? ¬øC√≥mo vas a llegar a ellos? ¬øExisten acuerdos de compra ya establecidos? Por ejemplo: "El producto ser√° comercializado a trav√©s de mercados campesinos locales, acuerdos con supermercados regionales, y venta directa a restaurantes. Ya contamos con cartas de intenci√≥n de compra de [X] clientes potenciales."')" class="text-green-700 underline">üí° Generar con IA</button>
                </div>
                <div id="respuestaMercado" class="hidden mt-2 bg-green-50 border-l-4 border-green-600 p-3 text-sm text-green-800 rounded"></div>
            </div>

            <div>
                <h3 class="text-lg font-semibold text-green-700 mb-2">7. Documentos Adjuntos (opcional)</h3>
                <input type="file" name="adjuntos" multiple class="input w-full bg-white border">
            </div>

            <div class="text-center">
                <button type="submit" class="bg-green-700 text-white px-8 py-3 rounded-md font-semibold hover:bg-green-800">Enviar Informaci√≥n</button>
            </div>

        </form>
    </section>

    <script>
        // Funci√≥n para aceptar una sugerencia de la IA y copiarla al textarea o input num√©rico
        function aceptarSugerencia(inputId, texto) {
            const inputField = document.getElementById(inputId);
            if (!inputField) return;

            // Si es un campo num√©rico, intenta limpiar el texto para que sea un n√∫mero
            if (inputField.type === 'number') {
                const cleanedText = texto.replace(/[^\d.]/g, ''); // Permite solo d√≠gitos y puntos decimales
                inputField.value = parseFloat(cleanedText) || ''; // Convierte a n√∫mero o vac√≠o si no es v√°lido
            } else {
                // Para campos de texto (textarea)
                inputField.value = texto;
            }

            const respuestaElement = document.getElementById(`respuesta${inputId.charAt(0).toUpperCase() + inputId.slice(1)}`);
            if (respuestaElement) {
                respuestaElement.classList.add('hidden'); // Oculta la sugerencia despu√©s de ser aceptada
            }
        }

        // Funci√≥n asincr√≥nica para generar texto utilizando la API de Hugging Face
        async function generarTextoIA(inputId, respuestaId, promptBase) {
            const inputElement = document.getElementById(inputId);
            const currentInput = inputElement.value;
            // Combina el prompt base con el texto actual del campo para un contexto m√°s rico
            const prompt = currentInput ? `Basado en lo siguiente: "${currentInput}", genera un texto m√°s detallado sobre: ${promptBase}.` : promptBase;
            const resultado = document.getElementById(respuestaId);
            resultado.innerHTML = "Generando sugerencia..."; // Mensaje de carga
            resultado.classList.remove('hidden');

            // --- ADVERTENCIA DE SEGURIDAD CR√çTICA ---
            // ¬°IMPORTANTE! Para un entorno de producci√≥n, NUNCA expongas tu API Key directamente
            // en el c√≥digo del lado del cliente como aqu√≠. Siempre debes manejar las llamadas a APIs
            // con claves sensibles a trav√©s de un servidor backend seguro.
            const HUGGING_FACE_API_KEY = "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"; // <-- TU API KEY AQU√ç

            // Modelo de IA m√°s capaz (puedes probar otros si este no cumple tus expectativas)
            const MODEL_NAME = "distilbert/distilgpt2"; 

            try {
                const response = await fetch(`https://api-inference.huggingface.co/models/${MODEL_NAME}`, {
                    method: "POST",
                    headers: {
                        "Authorization": `Bearer ${HUGGING_FACE_API_KEY}`,
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify({ 
                        inputs: prompt,
                        parameters: { max_new_tokens: 150, temperature: 0.7, repetition_penalty: 1.2 } // Ajusta estos par√°metros
                    })
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error || `Error HTTP: ${response.status}`);
                }

                const data = await response.json();
                if (data && data[0] && data[0].generated_text) {
                    let textoGenerado = data[0].generated_text.trim();
                    // Limpia el texto generado para eliminar el prompt original si se incluy√≥
                    if (textoGenerado.startsWith(prompt)) {
                        textoGenerado = textoGenerado.substring(prompt.length).trim();
                    }
                    // Quita saltos de l√≠nea y espacios extras al inicio/final
                    textoGenerado = textoGenerado.replace(/^\s*\n\s*|\s*\n\s*$/g, '');

                    resultado.innerHTML = `
                        <p>${textoGenerado}</p>
                        <button type="button" onclick="aceptarSugerencia('${inputId}', \`${textoGenerado.replace(/`/g, '\\`')}\`)" class="mt-2 bg-green-700 text-white px-3 py-1 rounded text-sm">‚úÖ Usar esta sugerencia</button>
                        <button type="button" onclick="generarTextoIA('${inputId}', '${respuestaId}', '${promptBase}')" class="mt-2 ml-2 bg-yellow-500 text-white px-3 py-1 rounded text-sm">üîÑ Regenerar</button>
                    `;
                } else {
                    resultado.innerText = "No se pudo generar una sugerencia. Por favor, intenta de nuevo o proporciona m√°s contexto.";
                }
            } catch (error) {
                console.error("Error al contactar la IA:", error);
                resultado.innerText = `Error al contactar la IA: ${error.message}. Verifica tu API Key o intenta m√°s tarde.`;
            }
        }
    </script>

</body>
</html>
